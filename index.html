<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=jE11kYfLkeS6DBKYMxnJFQ');.lst-kix_nyhulrmw8uyv-5>li:before{content:"-  "}.lst-kix_nyhulrmw8uyv-7>li:before{content:"-  "}.lst-kix_nyhulrmw8uyv-4>li:before{content:"-  "}.lst-kix_nyhulrmw8uyv-8>li:before{content:"-  "}.lst-kix_nyhulrmw8uyv-6>li:before{content:"-  "}ul.lst-kix_nyhulrmw8uyv-8{list-style-type:none}.lst-kix_nyhulrmw8uyv-0>li:before{content:"-  "}ul.lst-kix_nyhulrmw8uyv-7{list-style-type:none}ul.lst-kix_nyhulrmw8uyv-6{list-style-type:none}ul.lst-kix_nyhulrmw8uyv-5{list-style-type:none}ul.lst-kix_nyhulrmw8uyv-4{list-style-type:none}.lst-kix_nyhulrmw8uyv-1>li:before{content:"-  "}.lst-kix_nyhulrmw8uyv-3>li:before{content:"-  "}ul.lst-kix_nyhulrmw8uyv-3{list-style-type:none}ul.lst-kix_nyhulrmw8uyv-2{list-style-type:none}ul.lst-kix_nyhulrmw8uyv-1{list-style-type:none}ul.lst-kix_nyhulrmw8uyv-0{list-style-type:none}.lst-kix_nyhulrmw8uyv-2>li:before{content:"-  "}ol{margin:0;padding:0}table td,table th{padding:0}.c7{background-color:#ffffff;padding-top:0pt;border-bottom-color:#eaecef;border-bottom-width:0.8pt;padding-bottom:5.1pt;line-height:1.25;border-bottom-style:solid;orphans:2;widows:2;text-align:left}.c3{margin-left:-11pt;padding-top:8pt;padding-bottom:6pt;line-height:1.2;orphans:2;widows:2;text-align:left;margin-right:-11pt;height:20pt}.c2{color:#24292e;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Spectral";font-style:normal}.c8{color:#24292e;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Spectral";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:24pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c12{-webkit-text-decoration-skip:none;color:#1155cc;font-weight:700;text-decoration:underline;text-decoration-skip-ink:none;font-size:14pt}.c10{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c4{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c9{font-size:14pt;color:#24292e;font-weight:700}.c11{color:inherit;text-decoration:inherit}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c4"><h2 class="c7" id="h.kzah3mukq36j"><span class="c9">Starter Task : Metrics (</span><span class="c12"><a class="c11" href="https://www.google.com/url?q=https://pair-code.github.io/lit/demos/glue.html&amp;sa=D&amp;source=editors&amp;ust=1650041397180248&amp;usg=AOvVaw0XJCHHzou_irPAkJIfPuVw">Classification Demo</a></span><span class="c9">)</span></h2><p class="c1"><span class="c2">Classification tasks for machine learning models usually represent a classic scenario, where the models are trained on labeled data, and their performances are evaluated based on some measurements, &ldquo;metrics&rdquo;. </span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Let&rsquo;s consider the simplest scenario where there are only &nbsp;two &ldquo;types&rdquo; of data in our collection and we want to evaluate a model trained on this dataset. For our particular demo, our two &ldquo;types&rdquo; of data represent the two broad types of emotion (positive and negative) in movie reviews. Each &ldquo;type&rdquo; is called a class and as there are two classes in our data which we want to categorize using our model, this task is known as binary classification. </span></p><p class="c0"><span class="c2"></span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 469.50px; height: 129.41px;"><img alt="" src="images/image1.png" style="width: 469.50px; height: 129.41px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c2">So, what do we mean by measurements? Well, in simple terms, if the model predicts that a review has a positive sentiment and it actually does, then our model is accurate for that particular review. If we aggregate the performance of the model across all the reviews, then we obtain the performance levels of the model on the entire dataset.</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 194.26px; height: 154.50px;"><img alt="" src="images/image2.png" style="width: 194.26px; height: 154.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c2">But this description only covers one type of scenario where actual and predicted labels are both 1. There can be three other types of scenarios. The &ldquo;confusion matrix&rdquo; shown here illustrates the four possible scenarios and their nomenclatures.</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Now, with the background idea that model predictions can be true/false positives/negatives depending on the actual and predicted class labels, we can explore some of the fundamental metrics that are commonly used to evaluate model performance.</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 365.33px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 365.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c2">The LIT tool for our current demo presents 4 types of metrics. Accuracy, Precision, Recall, F1. All 4 of these can be represented in terms of ratios of the 4 types of quantities that we just described (true/false positives/negatives).</span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Accuracy is the ratio of correctly predicted observations to total observations. Precision is the ratio of correctly predicted positive observations to total predicted positive observations. Recall is the ratio of correctly predicted positive observations to all observations having class label 1. And F1 score is the weighted average of Precision and Recall.</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 158.67px;"><img alt="" src="images/image8.png" style="width: 624.00px; height: 158.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c2">By default, the Metrics component of the LIT tool displays the calculated values of the metrics across all the samples in the dataset (here N = 872). The correctness of these can also be manually verified using the above formulae, by plugging in the correct values of TN, TP, FP, FN from the confusion matrix. But, LIT Metrics can do more.</span></p><p class="c1"><span class="c2">For example, we can choose to facet the calculations by label. This would show us the calculations of the metrics for each of the class labels separately apart from showing us the overall values. So, here the accuracy for class label 0 is 0.808 and the accuracy for class label 1 is 0.833. This particular dataset is very balanced with nearly a 1:1 ratio of the number of samples for both the classes, but sometimes the class distribution may not be balanced in the input. Faceting by label would bring out this problem easily because if we do not take any counter-measures to solve the class distribution problem, the model would over-perform or under-perform for one of the classes. &nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 408.47px; height: 239.00px;"><img alt="" src="images/image3.png" style="width: 408.47px; height: 239.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 427.41px; height: 239.00px;"><img alt="" src="images/image6.png" style="width: 427.41px; height: 239.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c2">Another thing that we can do with the LIT tool is to check the metrics for individual examples or a small subset of examples. This can be a very useful method to understand if our model learnt useful features during training or not. For example, we can generate a counterfactual statement using one of the many generators like Hotflip, and check if the metrics are comparable even under perturbations. In this demo, I have generated a single hotflip example where the word &ldquo;affecting&rdquo; is replaced by the word &ldquo;worse&rdquo;, and the model is able to correctly classify this new sample as a negative sentiment.</span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">Also, accuracy as a metric is usually only useful when false positives and false negatives have a similar cost. Other metrics like Precision and Recall are more meaningful when the Cost ratio of FP/FN is not 1. The binary Classifier threshold module can be used to modify the cost ratio of FP/FN and then calculate an optimal threshold based on the new ratio. This offers a very helpful way to try out different desired cost ratios and thresholds and observe their impact on the different metrics for the model.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 288.50px; height: 251.51px;"><img alt="" src="images/image5.png" style="width: 288.50px; height: 251.51px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><p class="c1"><span class="c2">The choice of deciding which metric to rely on and when is indeed a very difficult one. As this answer from stackoverflow demonstrates, different use cases have different needs which lead to different metrics being preferred.</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 229.33px;"><img alt="" src="images/image7.png" style="width: 624.00px; height: 229.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c2">To conclude, this was a brief intro to metrics and model evaluation with focus on how to utilize the metrics component of the LIT tool to better understand the performance of our trained models. Thank you :)</span></p><h1 class="c3" id="h.5pqwpmvjxumf"><span class="c6"></span></h1><h1 class="c3" id="h.dzr6cociretw"><span class="c6"></span></h1><p class="c0"><span class="c5"></span></p></body></html>